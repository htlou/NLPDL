2025-01-12 13:56:33,083 INFO    MainThread:3438457 [wandb_setup.py:_flush():79] Current SDK version is 0.18.3
2025-01-12 13:56:33,084 INFO    MainThread:3438457 [wandb_setup.py:_flush():79] Configure stats pid to 3438457
2025-01-12 13:56:33,084 INFO    MainThread:3438457 [wandb_setup.py:_flush():79] Loading settings from /home/align-anything/.config/wandb/settings
2025-01-12 13:56:33,084 INFO    MainThread:3438457 [wandb_setup.py:_flush():79] Loading settings from /data/align-anything/hantao/NLPDL/project/NLPDL-project/train/scripts/wandb/settings
2025-01-12 13:56:33,084 INFO    MainThread:3438457 [wandb_setup.py:_flush():79] Loading settings from environment variables: {'api_key': '***REDACTED***'}
2025-01-12 13:56:33,084 INFO    MainThread:3438457 [wandb_setup.py:_flush():79] Applying setup settings: {'mode': None, '_disable_service': None}
2025-01-12 13:56:33,084 WARNING MainThread:3438457 [wandb_setup.py:_flush():79] Could not find program at -m safe_rlhf.finetune.__main__
2025-01-12 13:56:33,084 INFO    MainThread:3438457 [wandb_setup.py:_flush():79] Inferring run settings from compute environment: {'program_relpath': None, 'program': '-m safe_rlhf.finetune.__main__'}
2025-01-12 13:56:33,084 INFO    MainThread:3438457 [wandb_setup.py:_flush():79] Applying login settings: {}
2025-01-12 13:56:33,084 INFO    MainThread:3438457 [wandb_init.py:_log_setup():532] Logging user logs to /data/align-anything/hantao/NLPDL/project/NLPDL-project/train/output/sft/supervised_15/wandb/run-20250112_135633-1q9r04ty/logs/debug.log
2025-01-12 13:56:33,084 INFO    MainThread:3438457 [wandb_init.py:_log_setup():533] Logging internal logs to /data/align-anything/hantao/NLPDL/project/NLPDL-project/train/output/sft/supervised_15/wandb/run-20250112_135633-1q9r04ty/logs/debug-internal.log
2025-01-12 13:56:33,085 INFO    MainThread:3438457 [wandb_init.py:init():617] calling init triggers
2025-01-12 13:56:33,085 INFO    MainThread:3438457 [wandb_init.py:init():624] wandb.init called with sweep_config: {}
config: {'model_name_or_path': '/data/align-anything/hantao/models/alpaca-7b-reproduced', 'max_length': 2048, 'trust_remote_code': True, 'train_datasets': [('nlpdl-supervised', {'proportion': 1.0, 'path': '/data/align-anything/hantao/NLPDL/project/NLPDL-project/data/processed/supervised_train_15.json'})], 'eval_datasets': None, 'epochs': 3, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 2, 'gradient_checkpointing': True, 'lr': 1e-06, 'lr_scheduler_type': <SchedulerType.COSINE: 'cosine'>, 'lr_warmup_ratio': 0.03, 'weight_decay': 0.05, 'seed': 42, 'fp16': False, 'bf16': True, 'tf32': True, 'eval_strategy': 'epoch', 'eval_interval': 1000000, 'need_eval': False, 'eval_split_ratio': None, 'output_dir': '/data/align-anything/hantao/NLPDL/project/NLPDL-project/train/output/sft/supervised_15', 'log_type': 'wandb', 'log_dir': '/data/align-anything/hantao/NLPDL/project/NLPDL-project/train/output/sft/supervised_15', 'log_project': 'NLPDL', 'log_run_name': 'sft-2025-01-12-13-56-31', 'save_16bit': True, 'save_interval': 225, 'local_rank': 0, 'zero_stage': 3, 'offload': 'none', 'deepspeed': False, 'deepspeed_config': None, 'deepscale': False, 'deepscale_config': None, 'global_rank': 0, 'device': device(type='cuda', index=0), 'num_update_steps_per_epoch': 1, 'total_training_steps': 3}
2025-01-12 13:56:33,085 INFO    MainThread:3438457 [wandb_init.py:init():667] starting backend
2025-01-12 13:56:33,085 INFO    MainThread:3438457 [wandb_init.py:init():671] sending inform_init request
2025-01-12 13:56:33,088 INFO    MainThread:3438457 [backend.py:_multiprocessing_setup():104] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-01-12 13:56:33,088 INFO    MainThread:3438457 [wandb_init.py:init():684] backend started and connected
2025-01-12 13:56:33,092 INFO    MainThread:3438457 [wandb_init.py:init():779] updated telemetry
2025-01-12 13:56:33,099 INFO    MainThread:3438457 [wandb_init.py:init():812] communicating run to backend with 90.0 second timeout
2025-01-12 13:56:33,699 INFO    MainThread:3438457 [wandb_init.py:init():863] starting run threads in backend
2025-01-12 13:56:33,981 INFO    MainThread:3438457 [wandb_run.py:_console_start():2465] atexit reg
2025-01-12 13:56:33,982 INFO    MainThread:3438457 [wandb_run.py:_redirect():2313] redirect: wrap_raw
2025-01-12 13:56:33,982 INFO    MainThread:3438457 [wandb_run.py:_redirect():2378] Wrapping output streams.
2025-01-12 13:56:33,982 INFO    MainThread:3438457 [wandb_run.py:_redirect():2403] Redirects installed.
2025-01-12 13:56:33,986 INFO    MainThread:3438457 [wandb_init.py:init():907] run started, returning control to user process
2025-01-12 13:57:06,801 INFO    MainThread:3438457 [wandb_run.py:_finish():2164] finishing run htlou/NLPDL/1q9r04ty
2025-01-12 13:57:06,803 INFO    MainThread:3438457 [wandb_run.py:_atexit_cleanup():2428] got exitcode: 0
2025-01-12 13:57:06,803 INFO    MainThread:3438457 [wandb_run.py:_restore():2410] restore
2025-01-12 13:57:06,806 INFO    MainThread:3438457 [wandb_run.py:_restore():2416] restore done
2025-01-12 13:57:09,372 INFO    MainThread:3438457 [wandb_run.py:_footer_history_summary_info():4049] rendering history
2025-01-12 13:57:09,373 INFO    MainThread:3438457 [wandb_run.py:_footer_history_summary_info():4081] rendering summary
2025-01-12 13:57:09,384 INFO    MainThread:3438457 [wandb_run.py:_footer_sync_info():4008] logging synced files
