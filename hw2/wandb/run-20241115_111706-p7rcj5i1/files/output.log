/data/align-anything/hantao/NLPDL/hw2/train.py:136: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
11/15/2024 11:17:07 - WARNING - accelerate.utils.other - Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-11-15 11:17:08,037] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
11/15/2024 11:17:08 - INFO - root - gcc -pthread -B /home/align-anything/miniconda3/envs/hantao_stable/compiler_compat -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/align-anything/miniconda3/envs/hantao_stable/include -fPIC -O2 -isystem /home/align-anything/miniconda3/envs/hantao_stable/include -fPIC -c /tmp/tmp5zh15fjs/test.c -o /tmp/tmp5zh15fjs/test.o
11/15/2024 11:17:08 - INFO - root - gcc -pthread -B /home/align-anything/miniconda3/envs/hantao_stable/compiler_compat /tmp/tmp5zh15fjs/test.o -laio -o /tmp/tmp5zh15fjs/a.out
11/15/2024 11:17:08 - INFO - root - gcc -pthread -B /home/align-anything/miniconda3/envs/hantao_stable/compiler_compat -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/align-anything/miniconda3/envs/hantao_stable/include -fPIC -O2 -isystem /home/align-anything/miniconda3/envs/hantao_stable/include -fPIC -c /tmp/tmpt_hxwta0/test.c -o /tmp/tmpt_hxwta0/test.o
11/15/2024 11:17:08 - INFO - root - gcc -pthread -B /home/align-anything/miniconda3/envs/hantao_stable/compiler_compat /tmp/tmpt_hxwta0/test.o -L/home/align-anything/miniconda3/envs/hantao_stable -L/home/align-anything/miniconda3/envs/hantao_stable/lib64 -lcufile -o /tmp/tmpt_hxwta0/a.out
[34m[1mwandb[0m: [33mWARNING[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
  0%|                                                                                                                                                                                                                                                                                                      | 0/70 [00:00<?, ?it/s]/home/align-anything/miniconda3/envs/hantao_stable/lib/python3.11/site-packages/torch/nn/parallel/parallel_apply.py:79: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.device(device), torch.cuda.stream(stream), autocast(enabled=autocast_enabled):
/home/align-anything/miniconda3/envs/hantao_stable/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
 20%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                                                                                                                                                                                                                    | 14/70 [00:17<00:38,  1.45it/s]Traceback (most recent call last):
  File "/data/align-anything/hantao/NLPDL/hw2/train.py", line 158, in <module>â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:02<00:00,  2.27it/s]
    main()
  File "/data/align-anything/hantao/NLPDL/hw2/train.py", line 149, in main
    train_result = trainer.train()
                   ^^^^^^^^^^^^^^^
  File "/home/align-anything/miniconda3/envs/hantao_stable/lib/python3.11/site-packages/transformers/trainer.py", line 2085, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/align-anything/miniconda3/envs/hantao_stable/lib/python3.11/site-packages/transformers/trainer.py", line 2520, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, grad_norm, model, trial, epoch, ignore_keys_for_eval)
  File "/home/align-anything/miniconda3/envs/hantao_stable/lib/python3.11/site-packages/transformers/trainer.py", line 2951, in _maybe_log_save_evaluate
    metrics = self._evaluate(trial, ignore_keys_for_eval)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/align-anything/miniconda3/envs/hantao_stable/lib/python3.11/site-packages/transformers/trainer.py", line 2905, in _evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/align-anything/miniconda3/envs/hantao_stable/lib/python3.11/site-packages/transformers/trainer.py", line 3907, in evaluate
    output = eval_loop(
             ^^^^^^^^^^
  File "/home/align-anything/miniconda3/envs/hantao_stable/lib/python3.11/site-packages/transformers/trainer.py", line 4196, in evaluation_loop
    metrics = self.compute_metrics(
              ^^^^^^^^^^^^^^^^^^^^^
  File "/data/align-anything/hantao/NLPDL/hw2/train.py", line 115, in compute_metrics
    accuracy_metric = evaluate.load("accuracy")
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/align-anything/miniconda3/envs/hantao_stable/lib/python3.11/site-packages/evaluate/loading.py", line 748, in load
    evaluation_module = evaluation_module_factory(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/align-anything/miniconda3/envs/hantao_stable/lib/python3.11/site-packages/evaluate/loading.py", line 625, in evaluation_module_factory
    elif is_relative_path(path) and path.count("/") <= 1 and not force_local_path:
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/align-anything/miniconda3/envs/hantao_stable/lib/python3.11/site-packages/evaluate/utils/file_utils.py", line 72, in is_relative_path
    def is_relative_path(url_or_filename: str) -> bool:

KeyboardInterrupt
